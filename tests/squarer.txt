




instr XXX;squarer 107?
$INMIXT
;ingain
$PARAMT(1)
;slope
$PARAMT(2)
;envelope fixed
$PARAMT(3)
;volume
$PARAMT(4)

reset:
isizehalf = 16384
iroundness init 100
kslope = round((isizehalf - iroundness) * kpar_2 + iroundness)
islope = i(kslope)
itfun ftgentmp 0, 123, 16384, 8, -1, isizehalf - islope, -1,  islope, 0, islope, 1, isizehalf - islope, 1

;check for update slowly
ktrig  metro 10
kch changed kpar_2
kchng init 0
if kchng == 0 && kch == 1 then
    kchng = 1
endif
; reinit the transfer function
if kchng == 1 && ktrig == 1 then
    reinit reset
    kchng = 0
endif

asquared table3 ain * kpar1 * isizehalf, itfun
atrk follow2 ain, 0.03, 0.03
aenva CosSinMix asquared * atrk, asquared, kpar3

aout = aenva * kpar4 * kpar4 * 4
$OUTMIXT
endin